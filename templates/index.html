% import datetime
<!DOCTYPE html>
<html>
    <head>
        <title>Wer ist da?</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <link href="static/index.css" rel="stylesheet" />
    </head>
    <body>
      % if defined("saved"):
          <div class="{{ "saved" if saved else "deleted" }} message">
              ✓ {{ "gespeichert" if saved else "gelöscht" }}
              {{ datetime.datetime.now().strftime("%H:%M:%S") }}
          </div>
      % end
      % if mac != None:
          % device = ([ device for device in data["devices"] if device["mac"] == mac]  + [{}])[0]
        <form class="new-entry" action="/" method="post">
		<input type="text" id="name" name="name" placeholder="Name" value="{{ device.get("name", "") }}" /> 
            <span class="mac">{{ mac }}</span>
            <br/>
	    <textarea id="about" name="about" placeholder="über mich">{{ device.get("about", "") }}</textarea>
            <div class="options">
		    <input type="checkbox" name="there" {{ "checked" if device.get("there") else "" }}/>Anderen zeigen, dass ich da bin
                <br/>
                <input type="checkbox" name="away" {{ "checked" if device.get("away") else "" }} />Anderen zeigen, dass ich nicht da bin
            </div>
            <input type="submit" value="Speichern" />
        </form>
      % end
        <table class="devices">
            <tr class="heading">
                <td class="name">Name</td>
                <td class="presence">Anwesend</td>
                <td class="about">Beschreibung</td>
            </tr>
          % for device in data["devices"]:
            % is_present = device["mac"] in present
            % if not is_present and device["away"] or is_present and device["there"]:
            <tr class="device {{ 'present' if is_present else 'away' }}">
                <td class="name">{{ device["name"] }}</td>
                <td class="presence">{{ 'anwesend' if is_present else 'nicht da' }}</td>
                <td class="about">{{ device["about"] }}</td>
            </tr>
            % end
          % end
        </table>
        <footer>
            Schau dir den <a href="https://github.com/HashTec-Potsdam/wer-ist-da">Quelltext</a> an.
        </footer>
    </body>
</html>

